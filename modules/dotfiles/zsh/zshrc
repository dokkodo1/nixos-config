HISTSIZE=1000
SAVEHIST=1000
HISTFILE=~/.zsh/zsh_history
setopt HIST_IGNORE_DUPS      # Don't save duplicate commands
setopt HIST_IGNORE_SPACE     # Don't save commands starting with space
setopt SHARE_HISTORY         # Share history across all sessions
setopt HIST_VERIFY           # Show command with history expansion before running it
setopt AUTO_CD               # cd by just typing directory name
setopt CORRECT               # Suggest corrections for typos
setopt MENU_COMPLETE         # Automatically select first completion match
setopt AUTO_PUSHD            # Make cd push old directory onto directory stack
setopt PUSHD_IGNORE_DUPS     # Don't push duplicates onto directory stack

autoload -Uz compinit
compinit

# Case-insensitive completion
zstyle ':completion:*' matcher-list 'm:{a-zA-Z}={A-Za-z}'
# Menu-style completion
zstyle ':completion:*' menu select
# Colors in completion
zstyle ':completion:*' list-colors "${(s.:.)LS_COLORS}"

bindkey -e

if [[ -d "$HOME/.oh-my-zsh/plugins/git" ]]; then
    source "$HOME/.oh-my-zsh/plugins/git/git.plugin.zsh" 2>/dev/null || true
fi

alias wc3='wine Games/wc3/drive_c/Program\ Files/Warcraft\ 3/Warcraft\ III.exe'
alias twow='cd ~/Games/twmoa_1180 && wine explorer /desktop=TurtleWoW,1920x1080 WoW.exe'
alias ll='ls -lah'
alias tm='tmux-default'
alias screenshot='grim -g "$(slurp)" ~/Pictures/screenshot-$(date +%Y%m%d-%H%M%S).png'
alias screenshot-clip='grim -g "$(slurp)" - | wl-copy'
alias kde-start='dbus-run-session startplasma-wayland'
alias kde-stop='qdbus org.kde.Shutdown /Shutdown org.kde.Shutdown.logout'

wpaste() {
    local delay=${1:-5}
    nix shell nixpkgs#xdotool -c sh -c '
        echo "Focus the target window, typing in '"$delay"' seconds..."
        sleep '"$delay"'
        xdotool type "$(wl-paste)"
        echo "Done - clipboard typed."
    '
}

reload_zsh() {
    local repo_zshrc="$NIX_CONFIG_DIR/modules/dotfiles/zsh/zshrc"
    if [[ -f "$repo_zshrc" ]]; then
        source "$repo_zshrc"
        echo "zshrc reloaded from repo"
    else
        echo "Error: zshrc not found at $repo_zshrc"
    fi
}
alias zreload="reload_zsh"
