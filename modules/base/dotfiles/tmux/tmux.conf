#with  Basic settings
set-option -g focus-events on
set -g prefix C-a
unbind C-b
bind C-a send-prefix

# Start windows and panes at 1
set -g base-index 1
setw -g pane-base-index 1

# Vi mode
setw -g mode-keys vi

# ============================================================================
# NAVIGATION (Standard vim-tmux workflow)
# ============================================================================

# Window navigation - standard approach
bind-key -r C-h previous-window    # Ctrl-a Ctrl-h
bind-key -r C-l next-window        # Ctrl-a Ctrl-l
bind-key -r h previous-window      # Ctrl-a h (shortcut)
bind-key -r l next-window          # Ctrl-a l (shortcut)

# Pane navigation - vim-style hjkl
bind-key -r j select-pane -D       # Ctrl-a j (down)
bind-key -r k select-pane -U       # Ctrl-a k (up)  
bind-key -r h select-pane -L       # Ctrl-a h (left) - conflicts with window nav
bind-key -r l select-pane -R       # Ctrl-a l (right) - conflicts with window nav

# Resolve h/l conflict: use different keys for panes when you have multiple panes
bind-key -r C-j select-pane -D     # Ctrl-a Ctrl-j (down pane)
bind-key -r C-k select-pane -U     # Ctrl-a Ctrl-k (up pane)
bind-key -r C-h select-pane -L     # Ctrl-a Ctrl-h (left pane) 
bind-key -r C-l select-pane -R     # Ctrl-a Ctrl-l (right pane)

# Pane resizing - vim-style with Shift
bind-key -r H resize-pane -L 5     # Ctrl-a H (resize left)
bind-key -r J resize-pane -D 5     # Ctrl-a J (resize down)
bind-key -r K resize-pane -U 5     # Ctrl-a K (resize up)
bind-key -r L resize-pane -R 5     # Ctrl-a L (resize right)

# Live reload tmux config
bind-key r source-file ~/configurations/modules/base/dotfiles/tmux/tmux.conf \; display-message "tmux.conf reloaded from repo!"

# ============================================================================
# PANE MANAGEMENT
# ============================================================================

# Better pane splitting (more intuitive)
bind-key | split-window -h -c '#{pane_current_path}'  # Ctrl-a | (vertical split)
bind-key - split-window -v -c '#{pane_current_path}'  # Ctrl-a - (horizontal split)
unbind '"'
unbind %

# Quick pane layouts
bind-key Space next-layout         # Ctrl-a Space (cycle layouts)

# ============================================================================
# COPY MODE (vim-style)
# ============================================================================

# Enter copy mode
bind-key [ copy-mode              # Ctrl-a [ (standard)
bind-key Escape copy-mode         # Ctrl-a Escape (alternative)

# Vi-style copy mode bindings
bind-key -T copy-mode-vi v send-keys -X begin-selection
bind-key -T copy-mode-vi V send-keys -X select-line
bind-key -T copy-mode-vi C-v send-keys -X rectangle-toggle
bind-key -T copy-mode-vi y send-keys -X copy-selection-and-cancel
bind-key -T copy-mode-vi Escape send-keys -X cancel
bind-key -T copy-mode-vi C-c send-keys -X cancel

# Copy mode navigation (already vim-like by default with mode-keys vi)
# j/k = up/down, h/l = left/right, w/b = word forward/back, etc.

# Paste
bind-key ] paste-buffer           # Ctrl-a ] (paste most recent)
bind-key P choose-buffer          # Ctrl-a P (choose from buffer list)

# ============================================================================
# WINDOW MANAGEMENT  
# ============================================================================

# Create new window
bind-key c new-window -c '#{pane_current_path}'  # Ctrl-a c (new window, same dir)

# Quick window switching
bind-key 1 select-window -t 1    # Ctrl-a 1
bind-key 2 select-window -t 2    # Ctrl-a 2
# ... (numbers 1-9 work by default)

# Last window
bind-key Tab last-window          # Ctrl-a Tab (toggle between last two windows)

# ============================================================================
# SETTINGS
# ============================================================================

# Mouse support (works on desktop, ignored on TTY)
set -g mouse on

# Scrollback buffer
set -g history-limit 10000

# Clipboard integration
set -g set-clipboard on

# Renumber windows when one is closed
set -g renumber-windows on

# Faster command sequences
set -s escape-time 10

# Increase repeat timeout for -r bindings
set -g repeat-time 1000

# Monitor activity
setw -g monitor-activity off
set -g visual-activity on

# Don't auto-rename windows
set-option -g allow-rename off

# ============================================================================
# COLOR AND TERMINAL SETTINGS
# ============================================================================
#
#if-shell '[ "$TERM" = "linux" ]' \
#  'set -g default-terminal "screen"' \
#  'set -g default-terminal "tmux-256color"'
#
#if-shell '[ "$TERM" != "linux" ]' \
#  'set -ga terminal-overrides ",*256col*:Tc"'
# Fix colors and terminal capabilities
set -g default-terminal "tmux-256color"
#set -ga terminal-overrides ",*256col*:Tc"
#
## Enable true color support
#set-option -sa terminal-overrides ',xterm*:Tc'
